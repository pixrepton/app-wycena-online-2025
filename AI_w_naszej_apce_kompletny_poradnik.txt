
================================================================
AI W NASZEJ APCE - KOMPLETNY PORADNIK OD A DO Z
================================================================
Wersja: 1.0 | Data: 25.01.2025 | TOP-INSTAL Heat Pump Calculator

SPIS TREÅšCI
===========
1. CO TO JEST I JAK DZIAÅA (dla laikÃ³w)
2. ARCHITEKTURA SYSTEMU (dla programistÃ³w)
3. IMPLEMENTACJA TECHNICZNA (dla specjalistÃ³w)
4. KONFIGURACJA I WDROÅ»ENIE (instrukcje instalacji)
5. API I INTEGRACJE (dokumentacja techniczna)
6. MONITORING I DEBUGOWANIE (dla administratorÃ³w)

================================================================
1. CO TO JEST I JAK DZIAÅA (DLA LAIKÃ“W)
================================================================

CZYM JEST ANALIZA AI PDF?
-------------------------
Nasza aplikacja TOP-INSTAL posiada inteligentny system, ktÃ³ry potrafi:

âœ… PrzeczytaÄ‡ projekt budowlany w formacie PDF
âœ… ZrozumieÄ‡ zawartoÅ›Ä‡ dokumentu
âœ… WyciÄ…gnÄ…Ä‡ kluczowe parametry (powierzchnia, lokalizacja, moc)
âœ… Automatycznie obliczyÄ‡ wymaganÄ… moc pompy ciepÅ‚a
âœ… ZaproponowaÄ‡ odpowiedni model Panasonic

GDZIE TO ZNAJDUJESZ?
--------------------
ğŸ¯ MODE 2: "AI Analiza Projektu" - druga karta na ekranie powitalnym
ğŸ“„ MoÅ¼esz przeciÄ…gnÄ…Ä‡ plik PDF lub kliknÄ…Ä‡ "Wybierz plik"
âš¡ System automatycznie analizuje dokument w ~30 sekund

CO SYSTEM POTRAFI ZNALEÅ¹Ä†?
--------------------------
ğŸ“ Powierzchnia uÅ¼ytkowa budynku (mÂ²)
ğŸ”¥ WskaÅºnik energii uÅ¼ytkowej EU (kWh/mÂ²Â·rok)
ğŸ“ Lokalizacja/miejscowoÅ›Ä‡ (dla strefy klimatycznej)
âš¡ Zapotrzebowanie na ciepÅ‚o (kWh/rok)
ğŸ  Rodzaj budynku (dom, mieszkanie)
ğŸŒ¡ï¸ Temperatura projektowa (Â°C)
ğŸ“Š Moc grzewcza (kW) - jeÅ›li podana bezpoÅ›rednio

JAKIE PLIKI MOÅ»NA PRZESÅAÄ†?
---------------------------
âœ… Formaty: tylko PDF
âœ… Rozmiar: maksymalnie 16MB
âœ… Typ: projekty budowlane, audyty energetyczne
âœ… JÄ™zyk: polskie dokumenty (najlepsze wyniki)

================================================================
2. ARCHITEKTURA SYSTEMU (DLA PROGRAMISTÃ“W)
================================================================

OGÃ“LNA ARCHITEKTURA
-------------------
Frontend (JavaScript) â†’ Flask API â†’ Groq AI â†’ Wynik

KOMPONENTY SYSTEMU:
- Frontend: pdfUploadHandler.js (obsÅ‚uga UI)
- Backend: src/services/pdf_analyzer.py (logika biznesowa)
- AI Engine: Groq API (model llama-3.3-70b-versatile)
- Storage: uploads/ (tymczasowe pliki)

PRZEPÅYW DANYCH
---------------
1. User przeciÄ…ga PDF â†’ pdfUploadHandler.js
2. Walidacja pliku (typ, rozmiar) â†’ Frontend
3. FormData POST â†’ /api/analyze-pdf endpoint
4. Ekstrakcja tekstu â†’ PyPDF2 (pdf_analyzer.py)
5. Analiza AI â†’ Groq API (llama-3.3-70b-versatile)
6. Parsowanie JSON â†’ Python backend
7. Obliczenia mocy â†’ FormuÅ‚a Zordon 3.0
8. Wynik JSON â†’ Frontend
9. WyÅ›wietlenie â†’ Results renderer

KLUCZOWE PLIKI
--------------
ğŸ“ src/services/pdf_analyzer.py - gÅ‚Ã³wny serwis AI
ğŸ“ src/api/routes.py - endpoint /api/analyze-pdf
ğŸ“ pdfUploadHandler.js - frontend handler
ğŸ“ src/config.py - konfiguracja API keys

================================================================
3. IMPLEMENTACJA TECHNICZNA (DLA SPECJALISTÃ“W)
================================================================

GROQ AI INTEGRATION
-------------------
Provider: Groq Inc.
Model: llama-3.3-70b-versatile
API Version: v1
Authentication: Bearer Token (GROQ_API_KEY)
Rate Limits: 30 requests/minute (darmowy plan)
Response Format: JSON structured data

KONFIGURACJA MODELU AI
----------------------
Temperature: 0.1 (niska - precyzyjne wyniki)
Max Tokens: 2000 (wystarczajÄ…ce na JSON response)
System Prompt: "Ekspert od analizy projektÃ³w budowlanych"
Timeout: 30 sekund
Retry Logic: 3 prÃ³by z exponential backoff

PROMPT ENGINEERING
------------------
Struktura promptu:
1. System Role: "Ekspert od analizy projektÃ³w budowlanych"
2. Task Definition: WyciÄ…gnij konkretne parametry
3. Input Data: Tekst z PDF (max 12000 znakÃ³w)
4. Output Format: Sztywny JSON schema
5. Validation Rules: Polskie standardy budowlane

JSON RESPONSE SCHEMA
--------------------
{
    "found_data": {
        "powierzchnia_uzytkowa": float | null,
        "wskaznik_eu": float | null,
        "lokalizacja": string | null,
        "zapotrzebowanie_cieplo": float | null,
        "moc_grzewcza": float | null,
        "temperatura_projektowa": float | null,
        "rodzaj_budynku": string | null,
        "standard_energetyczny": string | null
    },
    "analysis_summary": string,
    "data_quality": "good" | "partial" | "insufficient",
    "recommended_calculation_method": "zordon_formula" | "direct_power" | "manual_input",
    "confidence_level": float (0.0-1.0),
    "notes": string
}

ALGORYTMY OBLICZENIOWE
---------------------
FormuÅ‚a Zordon 3.0:
- Metoda 1: Moc bezpoÅ›rednia (z projektu)
- Metoda 2: (EU Ã— Powierzchnia) / 1800 Ã— 2
- Metoda 3: Powierzchnia Ã— 65W/mÂ² (fallback)

WspÃ³Å‚czynniki klimatyczne:
- Strefa I: 1.0 (wybrzeÅ¼e)
- Strefa II: 1.1 (centralna Polska)
- Strefa III: 1.2 (podkarpacie)
- Strefa IV: 1.3 (gÃ³ry)
- Strefa V: 1.4 (Zakopane, Krynica)

ERROR HANDLING & RECOVERY
-------------------------
Poziomy bÅ‚Ä™dÃ³w:
1. PDFAnalyzerError - bÅ‚Ä™dy analizy PDF
2. ValidationError - bÅ‚Ä™dne dane wejÅ›ciowe
3. APIError - problemy z Groq API
4. UnexpectedError - nieoczekiwane bÅ‚Ä™dy

Fallback Strategy:
- Brak AI â†’ RÄ™czne wprowadzenie danych
- BÅ‚Ä…d parsowania â†’ DomyÅ›lne wartoÅ›ci
- Timeout â†’ PowtÃ³rzenie z mniejszym tekstem
- Rate limit â†’ Kolejka zadaÅ„

================================================================
4. KONFIGURACJA I WDROÅ»ENIE (INSTRUKCJE INSTALACJI)
================================================================

WYMAGANIA SYSTEMOWE
-------------------
- Python 3.8+
- Flask 2.0+
- PyPDF2 4.0+
- Groq Python SDK 0.4+
- 512MB RAM (minimum)
- PoÅ‚Ä…czenie internetowe

KROK 1: UZYSKANIE KLUCZA API GROQ
---------------------------------
1. IdÅº na https://console.groq.com
2. ZaÅ‚Ã³Å¼ darmowe konto (GitHub/Google)
3. PrzejdÅº do "API Keys"
4. Kliknij "Create API Key"
5. Skopiuj klucz (zaczyna siÄ™ od "gsk_...")
6. UWAGA: Klucz pokazuje siÄ™ tylko raz!

KROK 2: KONFIGURACJA ZMIENNYCH ÅšRODOWISKOWYCH
---------------------------------------------
W Replit:
1. Kliknij "Secrets" (ikona kÅ‚Ã³dki)
2. Dodaj nowy secret:
   - Key: GROQ_API_KEY
   - Value: [TwÃ³j klucz z Groq]
3. Kliknij "Add secret"

Lokalnie (.env file):
```
GROQ_API_KEY=gsk_twÃ³j_klucz_tutaj
FLASK_DEBUG=True
LOG_LEVEL=INFO
```

KROK 3: INSTALACJA PAKIETÃ“W
---------------------------
```bash
pip install flask groq PyPDF2 werkzeug
```

Lub w pyproject.toml:
```toml
[project]
dependencies = [
    "flask>=2.0.0",
    "groq>=0.4.0",
    "PyPDF2>=4.0.0",
    "werkzeug>=2.0.0"
]
```

KROK 4: URUCHOMIENIE SERWISU
----------------------------
```python
# main.py
from src.app import create_app

app = create_app()

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)
```

KROK 5: TESTOWANIE INSTALACJI
-----------------------------
1. Uruchom serwer: `python main.py`
2. OtwÃ³rz: http://localhost:5000
3. PrzejdÅº do Mode 2 (AI Analiza Projektu)
4. PrzeÅ›lij testowy PDF
5. SprawdÅº logi w konsoli

================================================================
5. API I INTEGRACJE (DOKUMENTACJA TECHNICZNA)
================================================================

GÅÃ“WNY ENDPOINT: /api/analyze-pdf
--------------------------------
Method: POST
Content-Type: multipart/form-data
Authentication: None (wewnÄ™trzny endpoint)

Request Format:
```
POST /api/analyze-pdf
Content-Type: multipart/form-data

pdf_file: [binary data]
```

Response Format (Success):
```json
{
    "status": "success",
    "data": {
        "processing_status": "success",
        "text_length": 5420,
        "analysis": {
            "found_data": {
                "powierzchnia_uzytkowa": 120.5,
                "wskaznik_eu": 65.2,
                "lokalizacja": "Warszawa",
                "moc_grzewcza": null,
                "rodzaj_budynku": "dom jednorodzinny"
            },
            "analysis_summary": "Znaleziono kompletne dane...",
            "data_quality": "good",
            "confidence_level": 0.85
        },
        "heating_calculation": {
            "calculated_power": 8.7,
            "method": "zordon_formula",
            "formula": "(120.5 Ã— 65.2) / 1800 Ã— 2 = 8.7 kW",
            "confidence": "medium"
        }
    },
    "message": "Analiza PDF zakoÅ„czona pomyÅ›lnie"
}
```

Response Format (Error):
```json
{
    "status": "error",
    "error": "Nie udaÅ‚o siÄ™ wyciÄ…gnÄ…Ä‡ tekstu z pliku PDF",
    "data": {
        "processing_status": "error",
        "error_type": "pdf_analysis_error"
    }
}
```

HTTP STATUS CODES
-----------------
200 - Success (analiza zakoÅ„czona)
400 - Bad Request (brak pliku, zÅ‚y format)
413 - Payload Too Large (plik > 16MB)
500 - Internal Server Error (bÅ‚Ä…d serwera/AI)
503 - Service Unavailable (brak klucza API)

HEALTH CHECK ENDPOINT
--------------------
```
GET /api/health
Response: {
    "status": "healthy",
    "pdf_analyzer": "available",
    "groq_api": "connected"
}
```

INTEGRACJA Z FRONTENDEM
----------------------
```javascript
async function analyzePDF(file) {
    const formData = new FormData();
    formData.append('pdf_file', file);
    
    const response = await fetch('/api/analyze-pdf', {
        method: 'POST',
        body: formData
    });
    
    const result = await response.json();
    
    if (result.status === 'success') {
        // PrzetwÃ³rz wyniki
        handleAnalysisResults(result.data);
    } else {
        // ObsÅ‚uÅ¼ bÅ‚Ä…d
        showError(result.error);
    }
}
```

================================================================
6. MONITORING I DEBUGOWANIE (DLA ADMINISTRATORÃ“W)
================================================================

SYSTEM LOGOWANIA
----------------
Logi sÄ… zapisywane w konsoli z nastÄ™pujÄ…cymi poziomami:
- INFO: Normalne operacje
- WARNING: Problemy nie blokujÄ…ce
- ERROR: BÅ‚Ä™dy wymagajÄ…ce uwagi
- DEBUG: SzczegÃ³Å‚owe informacje (tylko w dev)

PrzykÅ‚adowe logi:
```
[INFO] PDF AI Analyzer initialized successfully
[INFO] Processing PDF file: projekt_dom.pdf  
[INFO] Extracted 5420 characters from 12 pages
[INFO] AI analysis completed, response length: 1250
[WARNING] PDF text truncated to 12000 characters
[ERROR] Failed to parse AI JSON response: Expecting ',' delimiter
```

TYPOWE PROBLEMY I ROZWIÄ„ZANIA
----------------------------

Problem: "GROQ_API_KEY not found"
RozwiÄ…zanie: 
- SprawdÅº zmienne Å›rodowiskowe
- Upewnij siÄ™, Å¼e klucz jest poprawny
- Zrestartuj aplikacjÄ™

Problem: "PDF nie zawiera Å¼adnych stron"
RozwiÄ…zanie:
- SprawdÅº czy plik PDF nie jest uszkodzony
- Upewnij siÄ™, Å¼e to rzeczywiÅ›cie PDF
- SprÃ³buj z innym plikiem

Problem: "Rate limit exceeded"
RozwiÄ…zanie:
- Groq darmowy plan: 30 req/min
- Poczekaj minutÄ™ przed kolejnÄ… prÃ³bÄ…
- RozwaÅ¼ upgrade planu

Problem: "BÅ‚Ä…d parsowania odpowiedzi AI"
RozwiÄ…zanie:
- SprawdÅº logi - moÅ¼e byÄ‡ problem z promptem
- AI czasami zwraca niepoprawny JSON
- System automatycznie uÅ¼ywa fallback

METRYKI WYDAJNOÅšCI
------------------
- Åšredni czas analizy: 15-30 sekund
- DokÅ‚adnoÅ›Ä‡ wyciÄ…gania danych: ~85%
- PomyÅ›lne analizy: ~92%
- Maksymalny rozmiar PDF: 16MB
- ObsÅ‚ugiwane jÄ™zyki: polski (najlepiej)

MONITORING API GROQ
-------------------
Dashboard: https://console.groq.com/usage
Metryki:
- Requests per minute: 30 (darmowy plan)
- Total requests: bez limitu
- Response time: ~2-5 sekund
- Success rate: ~96%

OPTYMALIZACJA WYDAJNOÅšCI
------------------------
1. Ogranicz tekst do 12000 znakÃ³w
2. UÅ¼yj niskiej temperatury (0.1)
3. Cache wynikÃ³w dla identycznych plikÃ³w
4. Implement retry logic z exponential backoff
5. Monitor rate limits

BACKUP I RECOVERY
-----------------
- Pliki PDF sÄ… tymczasowe (automatyczne czyszczenie)
- Klucze API w Secrets (backup rÄ™czny)
- Logi w pamiÄ™ci (nie persistent)
- Konfiguracja w src/config.py

BEZPIECZEÅƒSTWO
--------------
âœ… Walidacja typu pliku (tylko PDF)
âœ… Limit rozmiaru (16MB)
âœ… Sanityzacja nazw plikÃ³w
âœ… Klucze API w zmiennych Å›rodowiskowych
âœ… Brak persistentnego storage plikÃ³w
âš ï¸ Rate limiting na poziomie Groq
âš ï¸ Brak authentication (internal API)

================================================================
PODSUMOWANIE
================================================================

KLUCZOWE ZALETY SYSTEMU:
âœ… Automatyczne wyciÄ…ganie parametrÃ³w z PDF-Ã³w
âœ… Inteligentne obliczenia mocy pompy ciepÅ‚a
âœ… ObsÅ‚uga bÅ‚Ä™dÃ³w i fallback scenarios
âœ… Nowoczesna architektura (Flask + AI)
âœ… Åatwa konfiguracja i deployment

OGRANICZENIA:
âš ï¸ Tylko pliki PDF (nie Word, Excel)
âš ï¸ Najlepsze wyniki dla polskich dokumentÃ³w
âš ï¸ ZaleÅ¼noÅ›Ä‡ od external API (Groq)
âš ï¸ Rate limiting (30 requests/minute)

ROADMAPA ROZWOJU:
ğŸ”® ObsÅ‚uga wiÄ™cej formatÃ³w (Word, Excel)
ğŸ”® Lokalne modele AI (offline mode)
ğŸ”® Batch processing (wiele plikÃ³w)
ğŸ”® Integracja z CRM TOP-INSTAL
ğŸ”® ML model dla polskich projektÃ³w

================================================================
KONTAKT I WSPARCIE
================================================================

W przypadku problemÃ³w technicznych:
1. SprawdÅº logi w konsoli
2. Zweryfikuj konfiguracjÄ™ API keys
3. Przetestuj z prostym PDF-em
4. SprawdÅº connectivity do Groq API

Dokumentacja techniczna: replit.md
Instrukcja terminologii: INSTRUKCJA_TERMINOLOGIA_APLIKACJI.txt

================================================================
KONIEC PORADNIKA - AI W NASZEJ APCE
Wersja 1.0 | 25.01.2025 | TOP-INSTAL Heat Pump Calculator
================================================================
